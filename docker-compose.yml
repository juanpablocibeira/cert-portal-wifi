services:
  cert-portal:
    build: .
    expose:
      - "8000"
    extra_hosts:
      - "host.docker.internal:host-gateway"
    volumes:
      - cert-portal-data:/app/data
      - cert-portal-certs:/app/certs
    environment:
      - APP_TITLE=${APP_TITLE:-Portal de Certificados WiFi}
      - SECRET_KEY=${SECRET_KEY:-cambiar-por-clave-segura-de-al-menos-32-caracteres}
      - FERNET_KEY=${FERNET_KEY}
      - DATABASE_URL=${DATABASE_URL:-sqlite+aiosqlite:///./data/portal.db}
      - SUPERADMIN_USERNAME=${SUPERADMIN_USERNAME:-admin}
      - SUPERADMIN_PASSWORD=${SUPERADMIN_PASSWORD:-admin}
      - SUPERADMIN_EMAIL=${SUPERADMIN_EMAIL:-admin@ejemplo.com}
      - PF_HOST=${PF_HOST:-https://localhost:9999}
      - PF_USERNAME=${PF_USERNAME:-admin}
      - PF_PASSWORD=${PF_PASSWORD:-}
      - PF_CERT_PROFILE=${PF_CERT_PROFILE:-default}
      - PF_VERIFY_SSL=${PF_VERIFY_SSL:-false}
      - JWT_EXPIRE_MINUTES=${JWT_EXPIRE_MINUTES:-480}
    restart: unless-stopped

volumes:
  cert-portal-data:
  cert-portal-certs:
